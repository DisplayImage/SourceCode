<header>
    <div class="content-wrapper">
        <div class="float-left">
            <p class="site-title">
                <a href="~/">ASP.NET Web API</a>
            </p>
        </div>
    </div>
</header>
<div id="body">
    <div class="jumbotron">
        <p class="lead">Using Web API Service in ASP.NET MVC: User Profile Avatar Change Demo</p>
    </div>
    <form role="form">
        <div class="form-group">
            <img alt="Avatar" src="~/Avatar/anonymous.gif" class="img-rounded" width="128" height="128" id="imgAvatar" />
        </div>
        <div class="form-group form-inline">
            <input id="txtUserId" type="text" class="form-control" placeholder="Enter UserId to get or set avatar" />
        </div>
        <div class="form-group form-inline">
            <input id="btnGetUserAvatar" type="button" width="128" class="btn btn-primary" value="Get Avatar" />
            <input id="btnSetUserAvatar" type="button" width="128" class="btn btn-primary" value="Set Avatar" />
        </div>
    </form>
    <div id="notification">
    </div>
</div>

<script type="text/javascript">
    function AjaxRequest(methodName, methodType, data, callback) {
        $.ajax({
            type: methodType,
            url: "api/" + methodName,
            data: JSON.stringify(data),
            contentType: "application/json; charset=utf-8",
            dataType: "json",
            success: function (result, status, xhr) {
                //When success the callback function is called
                if (callback) {
                    callback(result);
                }
            }
        });
    }
    function getUserAvatar() {
        AjaxRequest("Avatar?userId=" + $("#txtUserId").val(), "GET", {}, getCompletedUserAvatar);
    }
    function getCompletedUserAvatar(data) {
        if (data.UserAvatarBase64String !== null) {
            $("#imgAvatar").attr("src", "data:image/jpg;base64," + data.UserAvatarBase64String);
        } else {
            showAlertInfo("alert-danger", "No user have this UserId. Please check again!");
        }
    }
</script>
